{
  "publisher": "dkattan",
  "name": "copilot-breakpoint-debugger",
  "displayName": "Copilot Breakpoint Debugger",
  "version": "0.0.22",
  "_versionComment": "Version is auto-generated by the CI auto-release workflow. Manual edits are overwritten.",
  "description": "Use GitHub Copilot to automate starting, inspecting and resuming VS Code debug sessions with conditional breakpoints, exact numeric hit counts (hitCount), logpoints, and capture actions that interpolate variables inside log messages.",
  "license": "MIT",
  "homepage": "https://github.com/dkattan/Copilot-Breakpoint-Debugger#readme",
  "repository": {
    "type": "git",
    "url": "https://github.com/dkattan/Copilot-Breakpoint-Debugger"
  },
  "bugs": {
    "url": "https://github.com/dkattan/Copilot-Breakpoint-Debugger/issues"
  },
  "keywords": [
    "copilot",
    "debug",
    "breakpoint",
    "variables",
    "stack",
    "resume",
    "ai"
  ],
  "categories": [
    "Debuggers",
    "Other"
  ],
  "main": "./dist/extension.js",
  "icon": "images/icon.png",
  "engines": {
    "vscode": "^1.102.0"
  },
  "activationEvents": [
    "onLanguageModelTools",
    "onStartupFinished"
  ],
  "contributes": {
    "commands": [
      {
        "command": "copilotBreakpointDebugger.startAndWaitManual",
        "title": "Copilot Breakpoint Debugger: Manual Start & Wait",
        "category": "Copilot Breakpoint Debugger"
      },
      {
        "command": "copilotBreakpointDebugger.insertSampleStartDebuggerPayload",
        "title": "Copilot Breakpoint Debugger: Insert Sample Start Payload",
        "category": "Copilot Breakpoint Debugger"
      }
    ],
    "configuration": {
      "title": "Copilot Breakpoint Debugger",
      "properties": {
        "copilot-debugger.defaultLaunchConfiguration": {
          "type": "string",
          "default": "",
          "description": "Name of the default launch configuration to use when starting the debugger"
        },
        "copilot-debugger.entryTimeoutSeconds": {
          "type": "integer",
          "default": 60,
          "description": "Timeout in seconds waiting for initial entry stop after launching (before first user breakpoint). Supports long startup/build times; must be > 0."
        },
        "copilot-debugger.captureMaxVariables": {
          "type": "integer",
          "default": 40,
          "description": "Maximum number of variables auto-captured when a breakpoint action=capture omits variableFilter (capture-all mode)."
        },
        "copilot-debugger.serverReadyEnabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable serverReady automation (trigger + action). When disabled, provided serverReady payloads are ignored."
        },
        "copilot-debugger.serverReadyDefaultActionType": {
          "type": "string",
          "enum": [
            "httpRequest",
            "shellCommand",
            "vscodeCommand"
          ],
          "default": "httpRequest",
          "description": "Preferred serverReady action type surfaced in samples and quick insert command."
        },
        "copilot-debugger.maxBuildErrors": {
          "type": "integer",
          "default": 5,
          "description": "Maximum number of build diagnostics (from problem matchers) to include in error messages when debug session fails to start.",
          "scope": "resource"
        },
        "copilot-debugger.maxOutputLines": {
          "type": "integer",
          "default": 50,
          "description": "Maximum number of output lines (stderr/stdout) to buffer per debug session for runtime error reporting.",
          "scope": "resource"
        },
        "copilot-debugger.consoleLogLevel": {
          "type": "string",
          "enum": [
            "trace",
            "debug",
            "info",
            "warn",
            "error",
            "off"
          ],
          "default": "info",
          "description": "Controls how verbosely logs are mirrored to the developer console (Output panel always receives every log; this only gates console.* mirroring). Changes take effect immediately without reloading.",
          "scope": "window"
        },
        "copilot-debugger.enableTraceLogging": {
          "type": "boolean",
          "default": false,
          "description": "Emit verbose Debug Adapter Protocol trace logs to the output channel for troubleshooting.",
          "scope": "window"
        }
      }
    },
    "languageModelTools": [
      {
        "name": "start_debugger_with_breakpoints",
        "displayName": "Start Debugger",
        "toolReferenceName": "startDebugger",
        "canBeReferencedInPrompt": true,
        "userDescription": "Start a debug session, set breakpoints, and wait until a breakpoint is hit. Supports actions: break (pause & return), capture (collect variables & interpolated log messages then resume automatically; non-blocking), stopDebugging (terminate after hit). Supports serverReady.action types: httpRequest | shellCommand | vscodeCommand (auto-run after readiness trigger). Exact numeric hitCount pauses on that occurrence.",
        "modelDescription": "Start a debug session using the configured default launch configuration or an explicitly provided configurationName. Auto-selects sole launch config when none specified and no default setting is present. Each breakpoint can specify an action: break (pause), capture (non-blocking gather of variables & interpolation of {var} placeholders in logMessage then continue), or stopDebugging (terminate immediately after hit). Supports serverReady with trigger {path+line | pattern | omitted attach} and action.type httpRequest | shellCommand | vscodeCommand. Conditional expressions and exact numeric hitCount only. variableFilter required only for capture; omit to capture all locals up to captureMaxVariables.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "workspaceFolder": {
              "type": "string",
              "description": "Absolute path of an OPEN workspace folder (required)."
            },
            "configurationName": {
              "type": "string",
              "description": "Name of launch configuration to start. If omitted uses copilot-debugger.defaultLaunchConfiguration or auto-selects sole configuration if exactly one exists."
            },
            "breakpointConfig": {
              "type": "object",
              "properties": {
                "breakpoints": {
                  "type": "array",
                  "minItems": 1,
                  "items": {
                    "type": "object",
                    "properties": {
                      "path": {
                        "type": "string",
                        "description": "File path relative to workspace or absolute."
                      },
                      "line": {
                        "type": "integer",
                        "description": "1-based line number for the breakpoint."
                      },
                      "variableFilter": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "minItems": 1,
                        "description": "List of exact variable names to include when reporting variables for this breakpoint or for interpolation in capture action. Required only if action=capture and you want a subset; when omitted for capture all locals (up to captureMaxVariables) are auto-collected. Ignored for break/stopDebugging. Case-sensitive."
                      },
                      "action": {
                        "type": "string",
                        "enum": [
                          "break",
                          "capture",
                          "stopDebugging"
                        ],
                        "description": "Breakpoint action: break pauses and returns; capture collects variables & interpolated log messages then resumes (non-blocking); stopDebugging terminates session after hit. Default is break."
                      },
                      "condition": {
                        "type": "string",
                        "description": "Optional conditional expression (e.g., 'x > 5'). Breakpoint only triggers when condition evaluates to true."
                      },
                      "hitCount": {
                        "type": "integer",
                        "description": "Exact numeric hit count (3 means pause on 3rd hit)."
                      },
                      "logMessage": {
                        "type": "string",
                        "description": "Optional log message for logpoint or capture action. Uses curly braces for variable interpolation (e.g., 'Value is {x}'). If action=capture, interpolated messages are returned as capturedLogMessages."
                      },
                      "reasonCode": {
                        "type": "string",
                        "description": "Internal telemetry-friendly reason/tag (not surfaced in UI)."
                      }
                    },
                    "required": [
                      "path",
                      "line"
                    ]
                  },
                  "description": "Breakpoints to add before starting session."
                }
              }
            },
            "serverReady": {
              "type": "object",
              "description": "Optional server readiness automation. New flat schema: trigger {path+line | pattern | omitted attach}; action.type in httpRequest | shellCommand | vscodeCommand. Backward compatible with legacy shape.",
              "properties": {
                "trigger": {
                  "type": "object",
                  "description": "Readiness trigger. Provide either path+line for breakpoint or pattern for output-based readiness. Omit entirely for immediate attach execution.",
                  "properties": {
                    "path": {
                      "type": "string",
                      "description": "Breakpoint file path (relative or absolute)."
                    },
                    "line": {
                      "type": "integer",
                      "description": "1-based line number for breakpoint trigger."
                    },
                    "pattern": {
                      "type": "string",
                      "description": "Regex pattern matched against debug/task output for readiness."
                    }
                  }
                },
                "action": {
                  "type": "object",
                  "description": "Action executed when ready. Flat schema with discriminator 'type'.",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": [
                        "httpRequest",
                        "shellCommand",
                        "vscodeCommand"
                      ],
                      "description": "Action type discriminator."
                    },
                    "url": {
                      "type": "string",
                      "description": "Target URL (httpRequest)."
                    },
                    "method": {
                      "type": "string",
                      "description": "HTTP method (default GET)."
                    },
                    "headers": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      },
                      "description": "Optional HTTP headers."
                    },
                    "body": {
                      "type": "string",
                      "description": "Optional HTTP request body."
                    },
                    "shellCommand": {
                      "type": "string",
                      "description": "Shell command executed in a new terminal (shellCommand)."
                    },
                    "command": {
                      "type": "string",
                      "description": "VS Code command ID (vscodeCommand)."
                    },
                    "args": {
                      "type": "array",
                      "description": "Optional VS Code command arguments.",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "required": [
                    "type"
                  ]
                }
              },
              "required": [
                "action"
              ]
            }
          },
          "required": [
            "workspaceFolder",
            "breakpointConfig"
          ],
          "examples": [
            {
              "workspaceFolder": "/abs/path/project",
              "configurationName": "Run test.js",
              "breakpointConfig": {
                "breakpoints": [
                  {
                    "path": "src/server.ts",
                    "line": 27,
                    "action": "capture",
                    "logMessage": "port={PORT}",
                    "variableFilter": [
                      "PORT"
                    ]
                  }
                ]
              },
              "serverReady": {
                "trigger": {
                  "pattern": "listening on .*:(\\d+)"
                },
                "action": {
                  "type": "httpRequest",
                  "url": "http://localhost:%PORT%/swagger"
                }
              }
            },
            {
              "workspaceFolder": "/abs/path/project",
              "breakpointConfig": {
                "breakpoints": [
                  {
                    "path": "src/index.ts",
                    "line": 10
                  }
                ]
              },
              "serverReady": {
                "action": {
                  "type": "shellCommand",
                  "shellCommand": "curl http://localhost:3000/health"
                }
              }
            }
          ]
        }
      },
      {
        "name": "resume_debug_session",
        "displayName": "Resume Debug Session",
        "toolReferenceName": "resumeDebugSession",
        "when": "debugState == 'running'",
        "canBeReferencedInPrompt": true,
        "userDescription": "Resume a paused debug session optionally waiting for the next breakpoint. Supports actions (break, capture, stopDebugging) and numeric hitCount shorthand when adding new breakpoints during resume.",
        "modelDescription": "Resume execution of the specified debug session. Optionally wait for next stop and set/clear breakpoints before continuing. Each new breakpoint may specify action (break | capture | stopDebugging), conditional expressions, exact numeric hitCount, and logMessage interpolation for capture.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "sessionId": {
              "type": "string",
              "description": "ID of the debug session to resume."
            },
            "waitForStop": {
              "type": "boolean",
              "description": "If true, wait until the debugger stops again before returning."
            },
            "breakpointConfig": {
              "type": "object",
              "properties": {
                "breakpoints": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "path": {
                        "type": "string"
                      },
                      "line": {
                        "type": "integer"
                      },
                      "variableFilter": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "minItems": 1,
                        "description": "Variable names to include in reporting or interpolation for capture action."
                      },
                      "action": {
                        "type": "string",
                        "enum": [
                          "break",
                          "capture",
                          "stopDebugging"
                        ],
                        "description": "Breakpoint action applied during resume. Default break."
                      },
                      "condition": {
                        "type": "string",
                        "description": "Optional conditional expression (e.g., 'x > 5')."
                      },
                      "hitCount": {
                        "type": "integer",
                        "description": "Exact numeric hit count (pause on that occurrence)."
                      },
                      "logMessage": {
                        "type": "string",
                        "description": "Optional log message with {var} interpolation. Returned as capturedLogMessages if action=capture."
                      }
                    },
                    "required": [
                      "path",
                      "line"
                    ]
                  }
                }
              }
            }
          },
          "required": [
            "sessionId"
          ]
        }
      },
      {
        "name": "get_variables",
        "displayName": "Get Variables",
        "toolReferenceName": "getVariables",
        "canBeReferencedInPrompt": true,
        "userDescription": "Get all variables from the current debug session",
        "modelDescription": "Retrieve a list of all variables and their values from the current debug session when stopped at a breakpoint",
        "inputSchema": {
          "type": "object",
          "properties": {}
        }
      },
      {
        "name": "expand_variable",
        "displayName": "Expand Variable",
        "toolReferenceName": "expandVariable",
        "canBeReferencedInPrompt": true,
        "userDescription": "Show detailed contents and immediate children of a specific variable",
        "modelDescription": "Expand a specific variable to show its detailed contents and immediate child properties/elements when stopped at a breakpoint",
        "inputSchema": {
          "type": "object",
          "properties": {
            "variableName": {
              "type": "string",
              "description": "Name of the variable to expand"
            }
          },
          "required": [
            "variableName"
          ]
        }
      },
      {
        "name": "evaluate_expression",
        "displayName": "Evaluate Expression",
        "toolReferenceName": "evaluateExpression",
        "canBeReferencedInPrompt": true,
        "userDescription": "Evaluate an arbitrary expression (like in Debug Console) in the current paused debug context.",
        "modelDescription": "Use the DAP 'evaluate' request to evaluate code in the paused stack frame. Provide frameId implicitly using top frame.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "expression": {
              "type": "string",
              "description": "Expression to evaluate (e.g., variable name or small snippet)."
            },
            "sessionId": {
              "type": "string",
              "description": "Optional debug session id; defaults to active session."
            }
          },
          "required": [
            "expression"
          ]
        }
      },
      {
        "name": "stop_debug_session",
        "displayName": "Stop Debug Session",
        "toolReferenceName": "stopDebugSession",
        "canBeReferencedInPrompt": true,
        "userDescription": "Terminate one or more debug sessions matching a name (exit option).",
        "modelDescription": "Stop (terminate) all active debug sessions whose name matches the provided sessionName.",
        "inputSchema": {
          "type": "object",
          "properties": {
            "sessionName": {
              "type": "string",
              "description": "Name of the debug session to stop."
            }
          },
          "required": [
            "sessionName"
          ]
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run package",
    "compile": "tsc -p ./",
    "update": "vscode-ext-gen",
    "watch": "npm-run-all -p watch:*",
    "watch:esbuild": "node esbuild.js --watch",
    "watch:tsc": "tsc --noEmit --watch -p ./",
    "build:dist": "node esbuild.js --production",
    "package": "npm run build:dist",
    "compile-tests": "tsc -p ./",
    "pretest": "npm run lint && npm run compile-tests && npm run build:dist",
    "lint": "eslint",
    "test": "node -e \"try{require('fs').rmSync('./.vscode-test/user-data',{recursive:true,force:true});}catch(e){}\" && npx vscode-test",
    "test:coverage": "npm run compile-tests && npx vscode-test --coverage",
    "deps": "taze"
  },
  "dependencies": {
    "@actions/core": "^1.11.1",
    "@actions/github": "^6.0.0",
    "@anthropic-ai/sdk": "^0.27.3",
    "@vscode/prompt-tsx": "^0.4.0-alpha.5",
    "mocha": "^10.7.3",
    "reactive-vscode": "^0.4.1",
    "strip-ansi": "^7.1.2"
  },
  "devDependencies": {
    "@antfu/eslint-config": "^3.0.0",
    "@esbuild-plugins/node-modules-polyfill": "^0.2.2",
    "@types/mocha": "^10.0.10",
    "@types/node": "20.x",
    "@types/vscode": "^1.102.0",
    "@typescript-eslint/eslint-plugin": "^8.31.1",
    "@typescript-eslint/parser": "^8.31.1",
    "@vscode/debugprotocol": "^1.68.0",
    "@vscode/test-cli": "^0.0.12",
    "@vscode/test-electron": "^2.5.2",
    "esbuild": "^0.27.0",
    "esbuild-register": "^3.6.0",
    "eslint": "^9.25.1",
    "npm-run-all": "^4.1.5",
    "taze": "^19.9.2",
    "ts-node": "^10.9.2",
    "typescript": "^5.8.3",
    "vscode-ext-gen": "^1.4.0"
  },
  "overrides": {
    "glob": "10.5.0"
  }
}
